<html>

<head>
    <title>The Pages (Confirmation)</title>
    <link rel="stylesheet" type="text/css" href="/stylesheet.css">

    <script src="https://s3.amazonaws.com/stitch-sdks/js/bundles/4.0.0/stitch.js"></script>

    <script>

        const {
            Stitch,
            UserPasswordAuthProviderClient
        } = stitch;

        Stitch.initializeDefaultAppClient("thepages-qufuu");

        // Parse the URL query parameters
        const url = window.location.search;
        const params = new URLSearchParams(url);
        const token = params.get('token');
        const tokenId = params.get('tokenId');

        async function confirm() {
            // Confirm the user's email/password account
            const emailPassClient = Stitch.defaultAppClient.auth
                .getProviderClient(UserPasswordAuthProviderClient.factory);

            emailPassClient.confirmUser(token, tokenId)
            .then(result => {document.getElementById("success").innerHTML = "Confirmation Successful";},
            err => {document.getElementById("error").innerHTML = `Confirmation Failed: ${err}`});
        }

    </script>

</head>


<body onload="confirm()">

    <div id="success"></div>
    <div id="error"></div>

</body>

</html>